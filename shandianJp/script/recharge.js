!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,t.pingpp=e()}}(function(){return function e(t,n,a){function i(o,l){if(!n[o]){if(!t[o]){var c="function"==typeof require&&require;if(!l&&c)return c(o,!0);if(r)return r(o,!0);var s=new Error("Cannot find module '"+o+"'");throw s.code="MODULE_NOT_FOUND",s}var d=n[o]={exports:{}};t[o][0].call(d.exports,function(e){var n=t[o][1][e];return i(n||e)},d,d.exports,e,t,n,a)}return n[o].exports}for(var r="function"==typeof require&&require,o=0;o<a.length;o++)i(a[o]);return i}({1:[function(e,t,n){var a=e("./payment_elements.js");t.exports={userCallback:void 0,innerCallback:function(e,t){"function"==typeof this.userCallback&&(void 0===t&&(t=this.error()),this.userCallback(e,t),this.userCallback=void 0,a.clear())},error:function(e,t){return e=void 0===e?"":e,t=void 0===t?"":t,{msg:e,extra:t}}}},{"./payment_elements.js":22}],2:[function(e,t,n){var a=e("../utils"),i={}.hasOwnProperty;t.exports={ALIPAY_PC_DIRECT_URL:"https://mapi.alipay.com/gateway.do",handleCharge:function(e){var t=e.channel,n=e.credential[t],r=this.ALIPAY_PC_DIRECT_URL;i.call(n,"channel_url")&&(r=n.channel_url),i.call(n,"_input_charset")||(n._input_charset="utf-8");var o=a.stringifyData(n,t,!0);a.redirectTo(r+"?"+o)}}},{"../utils":25}],3:[function(e,t,n){var a=e("../utils"),i=e("../mods"),r={}.hasOwnProperty;t.exports={ALIPAY_WAP_URL_OLD:"https://wappaygw.alipay.com/service/rest.htm",ALIPAY_WAP_URL:"https://mapi.alipay.com/gateway.do",handleCharge:function(e){var t=e.channel,n=e.credential[t],o=this.ALIPAY_WAP_URL;r.call(n,"req_data")?o=this.ALIPAY_WAP_URL_OLD:r.call(n,"channel_url")&&(o=n.channel_url),r.call(n,"_input_charset")||(r.call(n,"service")&&"alipay.wap.create.direct.pay.by.user"===n.service||r.call(n,"req_data"))&&(n._input_charset="utf-8");var l=a.stringifyData(n,t,!0),c=o+"?"+l,s=i.getExtraModule("ap");a.inWeixin()&&void 0!==s?s.pay(c):a.redirectTo(c)}}},{"../mods":21,"../utils":25}],4:[function(e,t,n){var a=e("../utils"),i=e("../callbacks"),r={}.hasOwnProperty;t.exports={handleCharge:function(e){var t=e.channel,n=e.credential[t];return r.call(n,"url")?void a.redirectTo(n.url+"?"+a.stringifyData(n,t)):void i.innerCallback("fail",i.error("invalid_credential","missing_field:url"))}}},{"../callbacks":1,"../utils":25}],5:[function(e,t,n){var a=e("../../utils"),i=e("../../callbacks"),r={}.hasOwnProperty;t.exports={handleCharge:function(e){var t,n=e.credential[e.channel];if("string"==typeof n)t=n;else{if(!r.call(n,"url"))return void i.innerCallback("fail",i.error("invalid_credential","credential format is incorrect"));t=n.url}a.redirectTo(t)}}},{"../../callbacks":1,"../../utils":25}],6:[function(e,t,n){var a=e("../utils");t.exports={CP_B2B_URL:"https://payment.chinapay.com/CTITS/service/rest/page/nref/000000000017/0/0/0/0/0",handleCharge:function(e){var t=e.credential[e.channel];a.formSubmit(this.CP_B2B_URL,"post",t)}}},{"../utils":25}],7:[function(e,t,n){var a=e("./commons/redirect_base");t.exports={handleCharge:function(e){a.handleCharge(e)}}},{"./commons/redirect_base":5}],8:[function(e,t,n){arguments[4][7][0].apply(n,arguments)},{"./commons/redirect_base":5,dup:7}],9:[function(e,t,n){var a=e("../utils"),i={}.hasOwnProperty;t.exports={JDPAY_WAP_URL_OLD:"https://m.jdpay.com/wepay/web/pay",JDPAY_H5_URL:"https://h5pay.jd.com/jdpay/saveOrder",JDPAY_PC_URL:"https://wepay.jd.com/jdpay/saveOrder",handleCharge:function(e){var t=e.credential[e.channel],n=this.JDPAY_H5_URL;i.call(t,"channelUrl")?(n=t.channelUrl,delete t.channelUrl):i.call(t,"merchantRemark")&&(n=this.JDPAY_WAP_URL_OLD),a.formSubmit(n,"post",t)}}},{"../utils":25}],10:[function(e,t,n){var a=e("../callbacks"),i=e("../utils"),r=e("../stash"),o={}.hasOwnProperty;t.exports={SRC_URL:"http://pub.idqqimg.com/qqmobile/qqapi.js?_bid=152",ID:"mqq_api",handleCharge:function(e){var t=e.credential[e.channel];return o.call(t,"token_id")?(r.tokenId=t.token_id,void i.loadUrlJs(this.ID,this.SRC_URL,this.callpay)):void a.innerCallback("fail",a.error("invalid_credential","missing_token_id"))},callpay:function(){if("undefined"!=typeof mqq){if(0==mqq.QQVersion)return a.innerCallback("fail","Not in the QQ client"),void delete r.tokenId;mqq.tenpay.pay({tokenId:r.tokenId},a.userCallback)}else a.innerCallback("fail","network_err");delete r.tokenId}}},{"../callbacks":1,"../stash":23,"../utils":25}],11:[function(e,t,n){var a=e("../utils");t.exports={UPACP_PC_URL:"https://gateway.95516.com/gateway/api/frontTransReq.do",handleCharge:function(e){var t=e.credential[e.channel];a.formSubmit(this.UPACP_PC_URL,"post",t)}}},{"../utils":25}],12:[function(e,t,n){var a=e("../utils");t.exports={UPACP_WAP_URL:"https://gateway.95516.com/gateway/api/frontTransReq.do",handleCharge:function(e){var t=e.credential[e.channel];a.formSubmit(this.UPACP_WAP_URL,"post",t)}}},{"../utils":25}],13:[function(e,t,n){var a=e("../stash"),i=e("../callbacks"),r={}.hasOwnProperty;t.exports={handleCharge:function(e){for(var t=e.credential[e.channel],n=["appId","timeStamp","nonceStr","package","signType","paySign"],o=0;o<n.length;o++)if(!r.call(t,n[o]))return void i.innerCallback("fail",i.error("invalid_credential","missing_field_"+n[o]));a.jsApiParameters=t,this.callpay()},wxLiteEnabled:function(){return"undefined"!=typeof wx&&wx.requestPayment},callpay:function(){if(!this.wxLiteEnabled())return void console.log("请在微信小程序中打开");var e=a.jsApiParameters;delete e.appId,e.complete=function(e){"requestPayment:ok"===e.errMsg&&i.innerCallback("success"),"requestPayment:cancel"===e.errMsg&&i.innerCallback("cancel",i.error("用户取消支付")),"undefined"!==e.err_code&&"undefined"!==e.err_desc&&i.innerCallback("fail",i.error(e.err_desc,e))},wx.requestPayment(e)},runTestMode:function(e){wx.showModal({title:"提示",content:'因 "微信小程序" 限制 域名的原因 暂不支持 模拟付款 请使用 livekey 获取 charge 进行支付'})}}},{"../callbacks":1,"../stash":23}],14:[function(e,t,n){var a=e("../callbacks"),i=e("../utils"),r=e("../stash"),o=e("../mods"),l={}.hasOwnProperty;t.exports={PINGPP_NOTIFY_URL_BASE:"https://api.pingxx.com/notify",handleCharge:function(e){for(var t=e.credential[e.channel],n=["appId","timeStamp","nonceStr","package","signType","paySign"],i=0;i<n.length;i++)if(!l.call(t,n[i]))return void a.innerCallback("fail",a.error("invalid_credential","missing_field_"+n[i]));r.jsApiParameters=t,this.callpay()},callpay:function(){var e=this,t=o.getExtraModule("wx_jssdk");if(void 0!==t&&t.jssdkEnabled())t.callpay();else if("undefined"==typeof WeixinJSBridge){var n=function(){e.jsApiCall()};document.addEventListener?document.addEventListener("WeixinJSBridgeReady",n,!1):document.attachEvent&&(document.attachEvent("WeixinJSBridgeReady",n),document.attachEvent("onWeixinJSBridgeReady",n))}else this.jsApiCall()},jsApiCall:function(){l.call(r,"jsApiParameters")&&WeixinJSBridge.invoke("getBrandWCPayRequest",r.jsApiParameters,function(e){delete r.jsApiParameters,"get_brand_wcpay_request:ok"==e.err_msg?a.innerCallback("success"):"get_brand_wcpay_request:cancel"==e.err_msg?a.innerCallback("cancel"):a.innerCallback("fail",a.error("wx_result_fail",e.err_msg))})},runTestMode:function(e){if(confirm("模拟付款？")){var t=(null===e.or_id?"":"/orders/"+e.or_id)+"/charges/"+e.id;i.request(this.PINGPP_NOTIFY_URL_BASE+t+"?livemode=false","GET",null,function(e,t){if(t>=200&&t<400&&"success"==e)a.innerCallback("success");else{var n="http_code:"+t+";response:"+e;a.innerCallback("fail",a.error("testmode_notify_fail",n))}},function(){a.innerCallback("fail",a.error("network_err"))})}}}},{"../callbacks":1,"../mods":21,"../stash":23,"../utils":25}],15:[function(e,t,n){var a=e("../utils"),i=e("../callbacks"),r={}.hasOwnProperty;t.exports={handleCharge:function(e){var t=e.credential[e.channel];"string"==typeof t?a.redirectTo(t):"object"==typeof t&&r.call(t,"url")?a.redirectTo(t.url):i.innerCallback("fail",i.error("invalid_credential","credential 格式不正确"))}}},{"../callbacks":1,"../utils":25}],16:[function(e,t,n){var a=e("../utils"),i=e("../callbacks"),r={}.hasOwnProperty;t.exports={YEEPAY_WAP_URL:"https://ok.yeepay.com/paymobile/api/pay/request",YEEPAY_WAP_TEST_URL:"http://mobiletest.yeepay.com/paymobile/api/pay/request",handleCharge:function(e){for(var t=e.channel,n=e.credential[t],o=["merchantaccount","encryptkey","data"],l=0;l<o.length;l++)if(!r.call(n,o[l]))return void i.innerCallback("fail",i.error("invalid_credential","missing_field_"+o[l]));var c;c=r.call(n,"mode")&&"test"==n.mode?this.YEEPAY_WAP_TEST_URL:this.YEEPAY_WAP_URL,a.redirectTo(c+"?"+a.stringifyData(n,t,!0))}}},{"../callbacks":1,"../utils":25}],17:[function(e,t,n){var a=e("./utils"),i=e("./stash"),r=e("./libs/md5"),o={seperator:"###",limit:1,report_url:"https://statistics.pingxx.com/one_stats",timeout:100},l=function(e,t){var n=new RegExp("(^|&)"+t+"=([^&]*)(&|$)","i"),a=e.substr(0).match(n);return null!==a?unescape(a[2]):null},c=function(){return navigator.userAgent},s=function(){return window.location.host};o.store=function(e){if("undefined"!=typeof localStorage&&null!==localStorage){var t=this,n={};n.app_id=e.app_id||i.app_id||"app_not_defined",n.ch_id=e.ch_id||"",n.channel=e.channel||"",n.type=e.type||"",n.user_agent=c(),n.host=s(),n.time=(new Date).getTime(),n.puid=i.puid;var a="app_id="+n.app_id+"&channel="+n.channel+"&ch_id="+n.ch_id+"&host="+n.host+"&time="+n.time+"&type="+n.type+"&user_agent="+n.user_agent+"&puid="+n.puid,r=a;null!==localStorage.getItem("PPP_ONE_STATS")&&0!==localStorage.getItem("PPP_ONE_STATS").length&&(r=localStorage.getItem("PPP_ONE_STATS")+t.seperator+a);try{localStorage.setItem("PPP_ONE_STATS",r)}catch(e){}}},o.send=function(){if("undefined"!=typeof localStorage&&null!==localStorage){var e=this,t=localStorage.getItem("PPP_ONE_STATS");if(!(null===t||t.split(e.seperator).length<e.limit))try{for(var n=[],i=t.split(e.seperator),o=r(i.join("&")),c=0;c<i.length;c++)n.push({app_id:l(i[c],"app_id"),channel:l(i[c],"channel"),ch_id:l(i[c],"ch_id"),host:l(i[c],"host"),time:l(i[c],"time"),type:l(i[c],"type"),user_agent:l(i[c],"user_agent"),puid:l(i[c],"puid")});a.request(e.report_url,"POST",n,function(e,t){200==t&&localStorage.removeItem("PPP_ONE_STATS")},void 0,{"X-Pingpp-Report-Token":o})}catch(e){}}},o.report=function(e){var t=this;t.store(e),setTimeout(function(){t.send()},t.timeout)},t.exports=o},{"./libs/md5":19,"./stash":23,"./utils":25}],18:[function(e,t,n){var a=e("./stash"),i=e("./utils"),r=e("./collection");t.exports={SRC_URL:"https://cookie.pingxx.com",init:function(){var e=this;i.documentReady(function(){e.initPuid()})},initPuid:function(){if("undefined"!=typeof window&&"undefined"!=typeof localStorage){var e=localStorage.getItem("pingpp_uid");if(null===e){e=i.randomString();try{localStorage.setItem("pingpp_uid",e)}catch(e){}}if(a.puid=e,!document.getElementById("p_analyse_iframe")){var t=document.createElement("iframe");t.id="p_analyse_iframe",t.src=this.SRC_URL+"/?puid="+e,t.style.display="none",document.body.appendChild(t)}setTimeout(function(){r.send()},0)}}}},{"./collection":17,"./stash":23,"./utils":25}],19:[function(e,t,n){!function(){function e(e,t){var n=(65535&e)+(65535&t);return(e>>16)+(t>>16)+(n>>16)<<16|65535&n}function n(e,t){return e<<t|e>>>32-t}function a(t,a,i,r,o,l){return e(n(e(e(a,t),e(r,l)),o),i)}function i(e,t,n,i,r,o,l){return a(t&n|~t&i,e,t,r,o,l)}function r(e,t,n,i,r,o,l){return a(t&i|n&~i,e,t,r,o,l)}function o(e,t,n,i,r,o,l){return a(t^n^i,e,t,r,o,l)}function l(e,t,n,i,r,o,l){return a(n^(t|~i),e,t,r,o,l)}function c(t,n){t[n>>5]|=128<<n%32,t[14+(n+64>>>9<<4)]=n;var a,c,s,d,u,p=1732584193,m=-271733879,f=-1732584194,h=271733878;for(a=0;a<t.length;a+=16)c=p,s=m,d=f,u=h,p=i(p,m,f,h,t[a],7,-680876936),h=i(h,p,m,f,t[a+1],12,-389564586),f=i(f,h,p,m,t[a+2],17,606105819),m=i(m,f,h,p,t[a+3],22,-1044525330),p=i(p,m,f,h,t[a+4],7,-176418897),h=i(h,p,m,f,t[a+5],12,1200080426),f=i(f,h,p,m,t[a+6],17,-1473231341),m=i(m,f,h,p,t[a+7],22,-45705983),p=i(p,m,f,h,t[a+8],7,1770035416),h=i(h,p,m,f,t[a+9],12,-1958414417),f=i(f,h,p,m,t[a+10],17,-42063),m=i(m,f,h,p,t[a+11],22,-1990404162),p=i(p,m,f,h,t[a+12],7,1804603682),h=i(h,p,m,f,t[a+13],12,-40341101),f=i(f,h,p,m,t[a+14],17,-1502002290),m=i(m,f,h,p,t[a+15],22,1236535329),p=r(p,m,f,h,t[a+1],5,-165796510),h=r(h,p,m,f,t[a+6],9,-1069501632),f=r(f,h,p,m,t[a+11],14,643717713),m=r(m,f,h,p,t[a],20,-373897302),p=r(p,m,f,h,t[a+5],5,-701558691),h=r(h,p,m,f,t[a+10],9,38016083),f=r(f,h,p,m,t[a+15],14,-660478335),m=r(m,f,h,p,t[a+4],20,-405537848),p=r(p,m,f,h,t[a+9],5,568446438),h=r(h,p,m,f,t[a+14],9,-1019803690),f=r(f,h,p,m,t[a+3],14,-187363961),m=r(m,f,h,p,t[a+8],20,1163531501),p=r(p,m,f,h,t[a+13],5,-1444681467),h=r(h,p,m,f,t[a+2],9,-51403784),f=r(f,h,p,m,t[a+7],14,1735328473),m=r(m,f,h,p,t[a+12],20,-1926607734),p=o(p,m,f,h,t[a+5],4,-378558),h=o(h,p,m,f,t[a+8],11,-2022574463),f=o(f,h,p,m,t[a+11],16,1839030562),m=o(m,f,h,p,t[a+14],23,-35309556),p=o(p,m,f,h,t[a+1],4,-1530992060),h=o(h,p,m,f,t[a+4],11,1272893353),f=o(f,h,p,m,t[a+7],16,-155497632),m=o(m,f,h,p,t[a+10],23,-1094730640),p=o(p,m,f,h,t[a+13],4,681279174),h=o(h,p,m,f,t[a],11,-358537222),f=o(f,h,p,m,t[a+3],16,-722521979),m=o(m,f,h,p,t[a+6],23,76029189),p=o(p,m,f,h,t[a+9],4,-640364487),h=o(h,p,m,f,t[a+12],11,-421815835),f=o(f,h,p,m,t[a+15],16,530742520),m=o(m,f,h,p,t[a+2],23,-995338651),p=l(p,m,f,h,t[a],6,-198630844),h=l(h,p,m,f,t[a+7],10,1126891415),f=l(f,h,p,m,t[a+14],15,-1416354905),m=l(m,f,h,p,t[a+5],21,-57434055),p=l(p,m,f,h,t[a+12],6,1700485571),h=l(h,p,m,f,t[a+3],10,-1894986606),f=l(f,h,p,m,t[a+10],15,-1051523),m=l(m,f,h,p,t[a+1],21,-2054922799),p=l(p,m,f,h,t[a+8],6,1873313359),h=l(h,p,m,f,t[a+15],10,-30611744),f=l(f,h,p,m,t[a+6],15,-1560198380),m=l(m,f,h,p,t[a+13],21,1309151649),p=l(p,m,f,h,t[a+4],6,-145523070),h=l(h,p,m,f,t[a+11],10,-1120210379),f=l(f,h,p,m,t[a+2],15,718787259),m=l(m,f,h,p,t[a+9],21,-343485551),p=e(p,c),m=e(m,s),f=e(f,d),h=e(h,u);return[p,m,f,h]}function s(e){var t,n="";for(t=0;t<32*e.length;t+=8)n+=String.fromCharCode(e[t>>5]>>>t%32&255);return n}function d(e){var t,n=[];for(n[(e.length>>2)-1]=void 0,t=0;t<n.length;t+=1)n[t]=0;for(t=0;t<8*e.length;t+=8)n[t>>5]|=(255&e.charCodeAt(t/8))<<t%32;return n}function u(e){return s(c(d(e),8*e.length))}function p(e,t){var n,a,i=d(e),r=[],o=[];for(r[15]=o[15]=void 0,i.length>16&&(i=c(i,8*e.length)),n=0;n<16;n+=1)r[n]=909522486^i[n],o[n]=1549556828^i[n];return a=c(r.concat(d(t)),512+8*t.length),s(c(o.concat(a),640))}function m(e){var t,n,a="0123456789abcdef",i="";for(n=0;n<e.length;n+=1)t=e.charCodeAt(n),i+=a.charAt(t>>>4&15)+a.charAt(15&t);return i}function f(e){return unescape(encodeURIComponent(e))}function h(e){return u(f(e))}function _(e){return m(h(e))}function y(e,t){return p(f(e),f(t))}function v(e,t){return m(y(e,t))}function g(e,t,n){return t?n?y(t,e):v(t,e):n?h(e):_(e)}t.exports=g}()},{}],20:[function(e,t,n){var a=e("./version").v,i=e("./testmode"),r=e("./callbacks"),o=e("./mods"),l=e("./stash"),c=e("./collection"),s=e("./payment_elements"),d={}.hasOwnProperty,u=function(){e("./init").init()};u.prototype={version:a,createPayment:function(e,t,n,a){if("function"==typeof t&&(r.userCallback=t),s.init(e),!d.call(s,"id"))return void r.innerCallback("fail",r.error("invalid_charge","no_charge_id"));if(!d.call(s,"channel"))return void r.innerCallback("fail",r.error("invalid_charge","no_channel"));d.call(s,"app")&&("string"==typeof s.app?l.app_id=s.app:"object"==typeof s.app&&"string"==typeof s.app.id&&(l.app_id=s.app.id)),c.report({type:"pure_sdk_click",channel:s.channel,ch_id:s.id});var u=s.channel;if(!d.call(s,"credential"))return void r.innerCallback("fail",r.error("invalid_charge","no_credential"));if(!s.credential)return void r.innerCallback("fail",r.error("invalid_credential","credential_is_undefined"));if(!d.call(s.credential,u))return void r.innerCallback("fail",r.error("invalid_credential","credential_is_incorrect"));if(!d.call(s,"livemode"))return void r.innerCallback("fail",r.error("invalid_charge","no_livemode_field"));var p=o.getChannelModule(u);return void 0===p?(console.error('channel module "'+u+'" is undefined'),void r.innerCallback("fail",r.error("invalid_channel",'channel module "'+u+'" is undefined'))):!1===s.livemode?void(d.call(p,"runTestMode")?p.runTestMode(s):i.runTestMode(s)):(void 0!==n&&(l.signature=n),"boolean"==typeof a&&(l.debug=a),void p.handleCharge(s))},setAPURL:function(e){l.APURL=e}},t.exports=new u},{"./callbacks":1,"./collection":17,"./init":18,"./mods":21,"./payment_elements":22,"./stash":23,"./testmode":24,"./version":26}],21:[function(e,t,n){var a={}.hasOwnProperty,i={};t.exports=i,i.channels={alipay_pc_direct:e("./channels/alipay_pc_direct"),alipay_wap:e("./channels/alipay_wap"),bfb_wap:e("./channels/bfb_wap"),cp_b2b:e("./channels/cp_b2b"),fqlpay_qr:e("./channels/fqlpay_qr"),fqlpay_wap:e("./channels/fqlpay_wap"),jdpay_wap:e("./channels/jdpay_wap"),qpay_pub:e("./channels/qpay_pub"),upacp_pc:e("./channels/upacp_pc"),upacp_wap:e("./channels/upacp_wap"),wx_lite:e("./channels/wx_lite"),wx_pub:e("./channels/wx_pub"),wx_wap:e("./channels/wx_wap"),yeepay_wap:e("./channels/yeepay_wap")},i.extras={},i.getChannelModule=function(e){if(a.call(i.channels,e))return i.channels[e]},i.getExtraModule=function(e){if(a.call(i.extras,e))return i.extras[e]}},{"./channels/alipay_pc_direct":2,"./channels/alipay_wap":3,"./channels/bfb_wap":4,"./channels/cp_b2b":6,"./channels/fqlpay_qr":7,"./channels/fqlpay_wap":8,"./channels/jdpay_wap":9,"./channels/qpay_pub":10,"./channels/upacp_pc":11,"./channels/upacp_wap":12,"./channels/wx_lite":13,"./channels/wx_pub":14,"./channels/wx_wap":15,"./channels/yeepay_wap":16}],22:[function(e,t,n){var a=e("./callbacks"),i={}.hasOwnProperty;t.exports={id:null,or_id:null,channel:null,app:null,credential:{},extra:null,livemode:null,order_no:null,time_expire:null,init:function(e){var t;if("string"==typeof e)try{t=JSON.parse(e)}catch(e){return void a.innerCallback("fail",a.error("json_decode_fail",e))}else t=e;if(void 0===t)return void a.innerCallback("fail",a.error("json_decode_fail"));if(i.call(t,"object")&&"order"==t.object){t.or_id=t.id,t.id=t.charge,t.order_no=t.merchant_order_no;var n=t.charge_essentials;t.channel=n.channel,t.credential=n.credential,t.extra=n.extra}for(var r in this)i.call(t,r)&&(this[r]=t[r]);return this},clear:function(){for(var e in this)"function"!=typeof this[e]&&(this[e]=null)}}},{"./callbacks":1}],23:[function(e,t,n){t.exports={}},{}],24:[function(e,t,n){var a=e("./utils"),i={}.hasOwnProperty;t.exports={PINGPP_MOCK_URL:"http://sissi.pingxx.com/mock.php",runTestMode:function(e){var t={ch_id:e.id,scheme:"http",channel:e.channel};i.call(e,"or_id")&&null!==e.or_id&&(t.or_id=e.or_id),i.call(e,"order_no")?t.order_no=e.order_no:i.call(e,"orderNo")&&(t.order_no=e.orderNo),i.call(e,"time_expire")?t.time_expire=e.time_expire:i.call(e,"timeExpire")&&(t.time_expire=e.timeExpire),i.call(e,"extra")&&(t.extra=encodeURIComponent(JSON.stringify(e.extra))),a.redirectTo(this.PINGPP_MOCK_URL+"?"+a.stringifyData(t))}}},{"./utils":25}],25:[function(e,t,n){var a={}.hasOwnProperty,i=t.exports={stringifyData:function(e,t,n){void 0===n&&(n=!1);var i=[];for(var r in e)a.call(e,r)&&"function"!=typeof e[r]&&("bfb_wap"==t&&"url"==r||"yeepay_wap"==t&&"mode"==r||"channel_url"!=r&&i.push(r+"="+(n?encodeURIComponent(e[r]):e[r])));return i.join("&")},request:function(e,t,n,r,o,l){if("undefined"==typeof XMLHttpRequest)return void console.log("Function XMLHttpRequest is undefined.");var c=new XMLHttpRequest;if(void 0!==c.timeout&&(c.timeout=6e3),t=t.toUpperCase(),"GET"===t&&"object"==typeof n&&n&&(e+="?"+i.stringifyData(n,"",!0)),c.open(t,e,!0),void 0!==l)for(var s in l)a.call(l,s)&&c.setRequestHeader(s,l[s]);"POST"===t?(c.setRequestHeader("Content-type","application/json; charset=utf-8"),c.send(JSON.stringify(n))):c.send(),void 0===r&&(r=function(){}),void 0===o&&(o=function(){}),c.onreadystatechange=function(){4==c.readyState&&r(c.responseText,c.status,c)},c.onerror=function(e){o(c,0,e)}},formSubmit:function(e,t,n){if("undefined"==typeof window)return void console.log("Not a browser, form submit url: "+e);var i=document.createElement("form");i.setAttribute("method",t),i.setAttribute("action",e);for(var r in n)if(a.call(n,r)){var o=document.createElement("input");o.setAttribute("type","hidden"),o.setAttribute("name",r),o.setAttribute("value",n[r]),i.appendChild(o)}document.body.appendChild(i),i.submit()},randomString:function(e){void 0===e&&(e=32);for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=t.length,a="",i=0;i<e;i++)a+=t.charAt(Math.floor(Math.random()*n));return a},redirectTo:function(e){return"undefined"==typeof window?void console.log("Not a browser, redirect url: "+e):void window.location.replace(e)},inWeixin:function(){return"undefined"!=typeof navigator&&-1!==navigator.userAgent.toLowerCase().indexOf("micromessenger")},documentReady:function(e){return"undefined"==typeof document?void e():void("loading"!=document.readyState?e():document.addEventListener("DOMContentLoaded",e))},loadUrlJs:function(e,t,n){var a=document.getElementsByTagName("head")[0],i=null;null==document.getElementById(e)?(i=document.createElement("script"),i.setAttribute("type","text/javascript"),i.setAttribute("src",t),i.setAttribute("id",e),i.async=!0,null!=n&&(i.onload=i.onreadystatechange=function(){return!i.ready&&void(i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(i.ready=!0,n()))}),a.appendChild(i)):null!=n&&n()}}},{}],26:[function(e,t,n){t.exports={v:"2.1.7"}},{}]},{},[20])(20)});var rcNums=doc.getElementById("J-nums"),payNums=doc.getElementById("J-payNums"),payType=doc.getElementById("J-payType"),tipsWrap=doc.getElementById("J-tipsWrap"),pay_amount=doc.querySelector(".pay_amount"),amount=_p.queryStr("amount"),aid=_p.queryStr("aid"),oid=_p.queryStr("my_data"),activity_id=_p.queryStr("activity_id"),redirect=_p.queryStr("redirect"),rechargeNum=doc.getElementById("J-rechargeNum"),scaleArr=[],ti_now=(new Date).getTime(),main={init:function(){_p.setPayType(payType),_p.serviceBtn(doc.querySelector(".moreinfo")),api.method="get",api.url="77",mui.post("api.php",api,function(e){if("0000"==e.code){var t="";e.data.length;mui.each(e.data,function(e,n){var a="";if(0==e&&(a=" active",n.discount>100?(rcNums.className="total fav",rcNums.innerHTML="<span>"+n.account_limit+"拍币 + "+parseInt((n.discount-100)*n.account_limit/100)+"赠币</span>",payNums.innerHTML="￥<span>"+n.account_limit+".00</span>"):(rcNums.className="total",rcNums.innerHTML="<span>"+n.account_limit+" 拍币</span>",payNums.innerHTML="￥<span>"+n.account_limit+".00</span>")),t+='<a class="money_item'+a+(n.discount>100?" fav":"")+'" data-nums="'+n.account_limit+'" data-scale="'+n.discount+'">'+n.account_limit+"</a>",n.discount>100){var i={nums:n.account_limit,example:n.example,scale:n.discount};scaleArr.push(i)}}),amount||aid?(pay_amount.style.display="block",pay_amount.querySelector("em").innerHTML="￥"+amount+".00",doc.querySelector(".pay_nums").style.display="none",rcNums.className="total",rcNums.innerHTML="<span>"+amount+" 拍币</span>",payNums.innerHTML="￥<span>"+amount+".00</span>",redirect&&(sessionStorage.redirect=redirect)):scaleArr.length>0&&(tipsWrap.style.display="block",tipsWrap.querySelector(".intro").innerHTML="单笔金额充满"+scaleArr[0].nums+"元以上，即可享受充值金额"+(scaleArr[0].scale-100)+"%的额外赠送，赠送金额去余取整（"+scaleArr[0].example+"x"+(scaleArr[0].scale-100)+"%="+(scaleArr[0].example*(scaleArr[0].scale-100)/100).toFixed(1)+" 去余后赠送"+parseInt(scaleArr[0].example*(scaleArr[0].scale-100)/100)+"元）"),rechargeNum.innerHTML=t+rechargeNum.innerHTML}else"9997"==e.code?win.top.location="login.html?redirect=recharge.html":mui.toast(e.message)},"json")},re:function(){var e=arguments.callee;_p.loading(),api.method="get",api.url="74",api.order_id=oid,mui.post("api.php",api,function(t){if(t)if("0000"==t.code){if(!(activity_id>0)){_p.removeLoading();var n=["立即竞拍","查看余额明细"];return mui.confirm("",'<p class="tac right">充值成功</p>',n,function(e){0==e.index?location.replace("index.html"):1==e.index&&location.replace("mybalance.html?t=2")}),!1}var a=sessionStorage.redirect;sessionStorage.removeItem("redirect"),location.replace(a)}else"9997"==t.code&&(location.href="login.html?redirect="+encodeURIComponent(location.href));(new Date).getTime()-ti_now<6e3?setTimeout(e,500):(_p.removeLoading(),mui.toast("充值失败"),setTimeout(function(){if(activity_id>0){var e=sessionStorage.redirect;sessionStorage.removeItem("redirect"),location.replace(e)}else location.replace("mycenter.html")},1e3))},"json")},disPayType:function(e){var e=parseInt(e);mui("#J-payType li").each(function(){var t=this.getAttribute("data-limit"),n=this.getAttribute("data-limit-high"),a=this.getAttribute("data-ldesc"),i=this.getAttribute("data-lhdesc"),r=this.querySelector("h3 em");e<t?(this.className="dis",r.innerHTML=a):e>n?(this.className="dis",r.innerHTML=i):(this.classList.remove("dis"),r.innerHTML="")})},toRecharge:function(){if(this.classList.contains("dis"))mui.toast("请先同意用户协议");else{var e=payType.querySelector(".active");if(e)if("5"==e.getAttribute("data-channel")&&ua.match(/micromessenger/i))ua.match(/android/i)?(doc.querySelector(".wechat_tip").className="wechat_tip android",doc.querySelector(".wechat_tip span").innerHTML="在浏览器中打开"):(doc.querySelector(".wechat_tip").className="wechat_tip ios",doc.querySelector(".wechat_tip span").innerHTML="在Safari中打开"),doc.querySelector(".wechat_tip").style.display="block";else if(_user.id){var t=parseInt(e.getAttribute("data-limit")),n=parseInt(e.getAttribute("data-limit-high")),a=e.getAttribute("data-ldesc"),i=e.getAttribute("data-lhdesc"),r=parseInt(e.getAttribute("data-channel")),o=parseInt(e.getAttribute("data-platform")),l=payNums.querySelector("span")?parseInt(payNums.querySelector("span").innerHTML):0,c=location.origin+location.pathname.substring(0,location.pathname.lastIndexOf("/"))+"/recharge.html"+(aid>0?"?activity_id="+aid:"");l>0?l>=t?l<=n?(_p.loading(),api.method="post",api.url="75",api.amount=l,api.channel=r,api.pay_platform=o,api.open_id=localStorage.wxOpenId||0,api.success_url=c,api.cancel_url=location.href,aid>0&&(api.activity_id=aid),mui.post("api.php",api,function(e){if(_p.removeLoading(),"0000"==e.code)switch(o){case 1:location.href=e.data.wap_pay_url;break;case 2:break;case 3:pingpp.createPayment(e.data.trans_id,function(t,n){"success"==t?(oid=e.data.order_id,main.re()):"fail"==t?mui.toast("充值失败"+JSON.stringify(n)):"cancel"==t&&mui.toast("用户取消支付")})}else"vid"==e.code?(_p.vid(),mui.toast("网络异常，请重试")):mui.toast(e.message)},"json")):mui.toast(i):mui.toast(a):mui.toast("充值金额需大于0")}else location.href="login.html?redirect="+encodeURIComponent(location.href);else mui.toast("请选择充值方式")}}};mui.ready(function(){oid&&main.re(),setTimeout(function(){main.init()},5),mui(".mui-scroll-wrapper").scroll({indicators:!1,bounce:!0}),mui("#J-payType").on("tap","li",function(){var e=this.parentNode,t=e.querySelectorAll("li");this.classList.contains("dis")||(mui.each(t,function(e,t){t.classList.remove("active")}),this.classList.add("active"))}),mui(".pay_nums").on("tap",".money_item",function(){var e=this.parentNode,t=this.getAttribute("data-nums")||0,n=this.getAttribute("data-scale")||100,a=e.querySelectorAll(".money_item");mui.each(a,function(e,t){t.classList.remove("active")}),this.classList.add("active"),n>100?(rcNums.innerHTML="<span>"+t+"拍币+"+parseInt((n-100)*t/100)+"赠币</span>",payNums.innerHTML="￥<span>"+t+"</span>",doc.getElementById("J-otherNum").value="",doc.getElementById("J-otherNum").blur()):(rcNums.innerHTML="<span>"+t+"拍币</span>",payNums.innerHTML="￥<span>"+t+"</span>",0!=t&&(doc.getElementById("J-otherNum").value="",doc.getElementById("J-otherNum").blur())),main.disPayType(t)}),doc.querySelector(".wechat_tip").addEventListener("tap",function(){this.style.display="none"},!1),doc.querySelector(".agreement").addEventListener("tap",function(){var e=this.classList;e.contains("no")?(e.remove("no"),doc.getElementById("J-pay").classList.remove("dis")):(e.add("no"),doc.getElementById("J-pay").classList.add("dis"))},!1),wrap.addEventListener("keyup",function(e){var t=e.target;if(t.id="J-otherNum"){t.value=t.value.replace(/[^\d]/g,"");var n=t.value||0;if(n>=9999999)t.value="",rcNums.innerHTML="<span>0拍币</span>",payNums.innerHTML="￥<span>0</span>",mui.toast("数字过大，已清空！");else if(scaleArr.length>0&&n>=scaleArr[0].nums){for(var a=0,i=0,r=scaleArr.length;i<r&&n>=scaleArr[i].nums;i++)a=i;rcNums.innerHTML="<span>"+n+"拍币+"+parseInt((scaleArr[a].scale-100)*n/100)+"赠币</span>",payNums.innerHTML="￥<span>"+n+"</span>"}else rcNums.innerHTML="<span>"+n+"拍币</span>",payNums.innerHTML="￥<span>"+n+"</span>";main.disPayType(n)}}),doc.getElementById("J-pay").addEventListener("tap",main.toRecharge)});