function cb_login(){main.init()}function cb_user(){main.init()}var dayList=doc.querySelector(".day_list"),popPrize=doc.querySelector(".pop_prize"),timeline=doc.querySelector(".timeline"),btnSign=doc.getElementById("J-btnSign"),lxDays=doc.getElementById("lxdays"),days=doc.getElementById("J-days"),box=doc.getElementById("J-box"),pointType=["积分","赠币","拍币","购物币"],_init=1,main={init:function(){arguments.callee;sessionStorage.user_id>0?(ua.indexOf("gogobids")>-1&&sessionStorage.user_id>0&&(api.token=sessionStorage.token,api.userid=sessionStorage.user_id),api.url="84",api.method="get",mui.ajax("api.php?"+Math.floor(100*Math.random()),{data:api,dataType:"json",type:"post",timeout:1e4,success:function(i){if(_p.removeLoading(),"0000"==i.code){var e=i.data,a=cur=0,n=line="";days.innerHTML=e.continuous,a=e.continuous>6&&e.continuous%7==0?e.is_sign?7:0:e.continuous%7,e.is_sign?(btnSign.innerHTML="已签到",btnSign.classList.add("dis"),cur=a>0?a-1:0):(btnSign.innerHTML="签到领取",btnSign.classList.remove("dis"),cur=a),mui.each(e.info,function(i,e){var t="";award=e.award_count>0?pointType[e.award_product_type]+" x "+e.award_count:"",i<a&&(t+="ed"),i==cur&&(t+=" cur"),n+='<li class="'+t+'">第'+e.award_date_no+"天<em></em><p>"+award+"</p></li>"}),dayList.innerHTML=n,mui.each(e.status,function(i,a){var n="";a&&(n="box",0==i&&(e.is_sign&&(e.is_acquire?n+=" box3":n+=" box2"),e.is_acquire?box.className="box box3":e.is_sign&&(box.className="box box2"))),line+='<li class="'+n+'">'+(e.continuous>0?e.continuous+i:e.continuous+i+1)+"天</li>"}),timeline.innerHTML=line,e.continuous>0&&timeline.classList.add("oneday"),e.near>0?lxDays.innerHTML="再连续签到"+e.near+"天可领取":0==e.near?lxDays.innerHTML="您今日可领取":lxDays.innerHTML="再连续签到15天可领取"}else"vid"==i.code?_p.vid(main.init):"9997"==i.code?interactive.forward("login"):mui.toast(i.message)},error:function(){mui.toast("网络异常，请重试")}})):(api.url="85",api.method="get",mui.ajax("api.php",{data:api,dataType:"json",type:"post",timeout:1e4,success:function(i){if(_p.removeLoading(),"0000"==i.code){var e=(cur=0,line="");mui.each(i.data.info,function(i,a){var n=a.award_count>0?pointType[a.award_product_type]+" x "+a.award_count:"";e+="<li>第"+a.award_date_no+"天<em></em><p>"+n+"</p></li>"}),dayList.innerHTML=e,mui.each(i.data.status,function(i,e){var a="";e&&(a="box"),line+='<li class="'+a+'">'+(i+1)+"天</li>"}),timeline.innerHTML=line,i.data.near>0?lxDays.innerHTML="再连续签到"+i.data.near+"天可领取":0==i.data.near?lxDays.innerHTML="您今日可领取":lxDays.innerHTML="再连续签到15天可领取"}else"vid"==i.code?_p.vid(main.init):mui.toast(i.message)},error:function(){mui.toast("网络异常，请重试")}}))}};ua.indexOf("gogobids")>-1?sessionStorage.user_id>0||main.init():(_p.loading(),main.init()),mui.ready(function(){mui(".wrap").on("tap","a",function(){var i=this;switch(i.id){case"J-btnSign":sessionStorage.user_id>0?i.classList.contains("dis")||(api.url="86",api.method="post",mui.post("api.php",api,function(i){"0000"==i.code?(mui.toast("签到成功 +"+i.data.award_count+pointType[i.data.award_product_type]),main.init()):"9997"==i.code?interactive.forward("login"):mui.toast(i.message)},"json")):interactive.forward("login");break;case"J-box":sessionStorage.user_id>0?i.classList.contains("box2")&&!i.classList.contains("ed")?(i.classList.add("ed"),api.url="87",api.method="post",mui.post("api.php",api,function(i){if("0000"==i.code){var e=i.data,a=popPrize.querySelector(".nums"),n=pointType[e.award_product_type];popPrize.querySelector(".type").innerHTML=n,a.innerHTML=e.award_count,e.award_product_type>0&&a.classList.add("symbol"),popPrize.querySelector(".tips em").innerHTML=e.award_count+n,popPrize.style.display="block",main.init()}else"9997"==i.code?interactive.forward("login"):mui.toast(i.message)},"json")):mui.toast(lxDays.innerHTML):interactive.forward("login");break;default:this.href&&(location.href=this.href)}}),doc.querySelector(".pop_prize").addEventListener("tap",function(i){this.classList.add("hide")},!1)});