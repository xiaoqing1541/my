var page=1,html="",shareList=doc.getElementById("J-shareList"),main={refresh:function(){page=1,main.getData()},loadData:function(){page++,main.getData(1)},getData:function(i){api.url="39",api.method="get",api.limit=20,api.offset=(page-1)*api.limit,mui.post("api.php",api,function(e){mui("#mainContainer").pullRefresh().endPulldownToRefresh(),mui("#mainContainer").pullRefresh().endPullupToRefresh(!1),mui("#mainContainer").pullRefresh().enablePullupToRefresh(),"0000"==e.code?e.data.length>0?(html=i?shareList.innerHTML:"",mui.each(e.data,function(i,e){var a=btn="";mui.each(e.imgs.split(","),function(i,e){i<3&&(a+='<img src="'+envConfig.imgHost+e+'?imageView2/1/w/150/h/150">')}),html+='<div class="share_li"><div class="cover"><img src="'+e.avatar+'?imageView2/1/w/90/h/90" /></div><div class="title"><span class="name">'+e.nickname+'</span><span class="time">'+_p.getDateTime(e.show_time)+'</span></div><div class="share_info" data-id="'+e.id+'"><h3 class="hidelong">'+e.title+'</h3><div class="desc">'+e.content+'</div><div class="imgs">'+a+"</div></div></div>"}),shareList.innerHTML=html,e.data.length<api.limit?1==page?mui("#mainContainer").pullRefresh().disablePullupToRefresh():mui("#mainContainer").pullRefresh().endPullupToRefresh(!0):(mui("#mainContainer").pullRefresh().endPullupToRefresh(!1),mui("#mainContainer").pullRefresh().enablePullupToRefresh())):(1==page&&(shareList.innerHTML='<div class="ui-nodata"></div>',mui("#mainContainer").pullRefresh().disablePullupToRefresh()),mui("#mainContainer").pullRefresh().endPullupToRefresh(!0)):"9997"==e.code?win.top.location="login.html?redirect=share.html":mui.toast(e.message)},"json")}};mui.ready(function(){setTimeout(function(){main.refresh()},5),mui.init({pullRefresh:{container:"#mainContainer",down:{callback:main.refresh},up:{callback:main.loadData}}}),mui(".wrap").on("tap",".share_info",function(){this.getAttribute("data-id")&&(win.top.location="share_detail.html?id="+this.getAttribute("data-id"))}),mui(".wrap").on("tap","a",function(){this.href&&(win.top.location=this.href)})});